# ⚡ 快速操作：添加学校模板

## 📍 你现在在哪里？
你正在看 `CUSTOMIZATION_GUIDE.md` 文件的第 283 行附近的 SQL 代码示例。

## 🎯 你要做什么？
把这些 SQL 代码复制到数据库中，让系统添加一个新的学校模板。

---

## 🚀 三分钟快速操作

### 步骤1️⃣：打开数据库管理界面（30秒）

**使用 Supabase：**
1. 浏览器打开 https://supabase.com
2. 登录 → 选择你的项目
3. 左侧菜单点击 **SQL Editor** (有 `</>` 图标)

**使用其他数据库工具：**
- pgAdmin: 打开 → 选择数据库 → 点击 "Query Tool"
- DBeaver: 打开 → 右键数据库 → "SQL Editor" → "New SQL Script"

---

### 步骤2️⃣：复制代码（1分钟）

回到 `CUSTOMIZATION_GUIDE.md`，找到你想要的示例（比如清华大学示例，第260-323行）。

**选择并复制整段代码：**

```sql
INSERT INTO "SchoolFormTemplate" (...)
VALUES (
  'tsinghua-undergrad-2024',
  'tsinghua-university',
  '清华大学',
  ...
);
```

**复制方法：**
- 点击代码开头
- 按住鼠标左键拖到代码末尾 `);`
- `Ctrl+C` 复制 (Mac 用 `Cmd+C`)

---

### 步骤3️⃣：修改信息（1分钟）

**必须修改的5个地方**（否则会报错！）：

```sql
INSERT INTO "SchoolFormTemplate" ("id", "schoolId", "schoolName", "program", "description", "fieldsData", "isActive", "createdAt", "updatedAt")
VALUES (
  'fudan-undergrad-2024',          ← ①改这里：改成你的ID
  'fudan-university',               ← ②改这里：改成学校代码
  '复旦大学',                       ← ③改这里：改成学校名称
  '2024年本科招生',                 ← ④改这里：改成项目名称
  '复旦大学本科生综合评价招生',    ← ⑤改这里：改成描述
  jsonb_build_array(
    ... 字段配置可以先不改，保持原样 ...
  ),
  true,
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP
);
```

**💡 提示**：
- ID 必须是唯一的，不能重复
- 建议格式：`学校拼音-项目类型-年份`
- 例如：`fudan-undergrad-2024`, `pku-graduate-2024`

---

### 步骤4️⃣：运行代码（30秒）

1. **粘贴**：在 SQL Editor 的文本框中 `Ctrl+V` 粘贴代码
2. **检查**：确保代码完整，最后有 `);`
3. **运行**：
   - 点击 **"Run"** 按钮（通常是蓝色的）
   - 或按 `Ctrl+Enter` (Mac: `Cmd+Enter`)

**✅ 成功标志：**
```
Success. No rows returned
```

**❌ 如果出错：**
- 检查是否有拼写错误
- 检查 ID 是否已存在（如果存在，改成新的 ID）
- 检查括号、引号是否配对

---

### 步骤5️⃣：验证（30秒）

1. 回到你的**学校申请助手应用**
2. 按 `F5` 刷新页面
3. 进入**仪表板**或**创建新申请**
4. 你应该能看到新添加的学校！

---

## 📋 完整示例：从零开始添加复旦大学

### 原始代码（从 CUSTOMIZATION_GUIDE.md 复制）：

```sql
INSERT INTO "SchoolFormTemplate" ("id", "schoolId", "schoolName", "program", "description", "fieldsData", "isActive", "createdAt", "updatedAt")
VALUES (
  'tsinghua-undergrad-2024',
  'tsinghua-university',
  '清华大学',
  '2024年本科招生',
  '清华大学本科生综合评价招生申请',
  jsonb_build_array(
    jsonb_build_object(
      'id', 'personal',
      'label', '个人信息',
      'type', 'section',
      'fields', jsonb_build_array(
        jsonb_build_object('id', 'name', 'label', '姓名', 'type', 'text', 'required', true, 'aiFillRule', 'basicInfo.fullName'),
        jsonb_build_object('id', 'phone', 'label', '手机号码', 'type', 'tel', 'required', true, 'aiFillRule', 'basicInfo.phone')
      )
    ),
    jsonb_build_object(
      'id', 'personal_statement',
      'label', '个人陈述',
      'type', 'textarea',
      'required', true,
      'maxLength', 800
    )
  ),
  true,
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP
);
```

### 修改后的代码（准备运行）：

```sql
INSERT INTO "SchoolFormTemplate" ("id", "schoolId", "schoolName", "program", "description", "fieldsData", "isActive", "createdAt", "updatedAt")
VALUES (
  'fudan-undergrad-2024',              -- 改了
  'fudan-university',                   -- 改了
  '复旦大学',                           -- 改了
  '2024年本科招生',                     -- 保持不变或修改
  '复旦大学本科生综合评价招生申请',    -- 改了
  jsonb_build_array(
    jsonb_build_object(
      'id', 'personal',
      'label', '个人信息',
      'type', 'section',
      'fields', jsonb_build_array(
        jsonb_build_object('id', 'name', 'label', '姓名', 'type', 'text', 'required', true, 'aiFillRule', 'basicInfo.fullName'),
        jsonb_build_object('id', 'phone', 'label', '手机号码', 'type', 'tel', 'required', true, 'aiFillRule', 'basicInfo.phone')
      )
    ),
    jsonb_build_object(
      'id', 'personal_statement',
      'label', '个人陈述',
      'type', 'textarea',
      'required', true,
      'maxLength', 800
    )
  ),
  true,
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP
);
```

---

## 🎯 字段配置说明（进阶）

如果你想修改表单字段，只需要修改 `jsonb_build_array(...)` 里面的内容：

### 添加一个文本字段：

```sql
jsonb_build_object(
  'id', 'student_id',        -- 字段ID（英文）
  'label', '学号',           -- 显示名称（中文）
  'type', 'text',            -- 字段类型
  'required', true,          -- 是否必填
  'aiFillRule', ''           -- AI填充规则（可选）
)
```

### 添加一个多行文本字段：

```sql
jsonb_build_object(
  'id', 'essay',
  'label', '个人陈述',
  'type', 'textarea',
  'required', true,
  'maxLength', 1000,
  'helpText', '请简述你的申请理由（1000字以内）'
)
```

### 添加一个下拉选择字段：

```sql
jsonb_build_object(
  'id', 'gender',
  'label', '性别',
  'type', 'select',
  'required', true,
  'options', jsonb_build_array('男', '女', '其他')
)
```

### 字段类型对照表：

| 字段类型 | 说明 | 用途示例 |
|---------|------|---------|
| `text` | 单行文本 | 姓名、学号、学校名 |
| `email` | 邮箱 | 联系邮箱 |
| `tel` | 电话 | 手机号码 |
| `date` | 日期 | 生日、毕业日期 |
| `textarea` | 多行文本 | 个人陈述、简历 |
| `select` | 下拉选择 | 性别、学历、专业类别 |

---

## 🔧 常见错误及解决方法

### 错误1：`duplicate key value violates unique constraint`

**原因**：ID 已经存在
**解决**：改一个新的 ID，比如 `fudan-undergrad-2025`

### 错误2：`syntax error at or near "..."`

**原因**：少了引号、括号或逗号
**解决**：
- 检查每个字符串是否有配对的引号 `'...'`
- 检查每个括号是否配对 `(...)` `{...}`
- 检查逗号是否正确（最后一项后面不要加逗号）

### 错误3：`column "..." does not exist`

**原因**：列名拼写错误
**解决**：确保列名和数据库 schema 一致（区分大小写！）

---

## 💡 贴心提示

### ✅ 建议做的事：
- 先在记事本里修改好代码，再粘贴到 SQL Editor
- 保存一份你修改的 SQL 代码，方便以后参考
- 从简单的示例开始（字段少的）
- 一次只添加一个学校模板

### ❌ 不要做的事：
- 不要同时运行多条 INSERT 语句
- 不要删除代码中的逗号、括号
- 不要修改 `CURRENT_TIMESTAMP`
- 不要使用中文标点符号（`, ， 。`）

---

## 🎓 我是绝对新手，能再简化吗？

**可以！** 最简单的方法：

### 第一次添加学校（最小示例）：

```sql
INSERT INTO "SchoolFormTemplate" ("id", "schoolId", "schoolName", "program", "description", "fieldsData", "isActive", "createdAt", "updatedAt")
VALUES (
  'my-first-school-2024',
  'my-school',
  '我的第一个学校',
  '测试项目',
  '这是一个测试学校模板',
  jsonb_build_array(
    jsonb_build_object(
      'id', 'name',
      'label', '姓名',
      'type', 'text',
      'required', true
    )
  ),
  true,
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP
);
```

**这个示例**：
- ✅ 只有一个字段（姓名）
- ✅ 非常简单，不容易出错
- ✅ 可以直接复制运行
- ✅ 用来测试流程

**运行成功后**，你就掌握了基本操作，然后可以添加更复杂的模板！

---

## 📞 需要帮助？

告诉我：
1. 你在哪一步遇到问题？
2. 出现了什么错误信息？
3. 你想添加什么学校？

我会给你更具体的帮助！🚀

