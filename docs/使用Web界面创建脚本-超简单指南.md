# 使用Web界面创建自动申请脚本 - 超简单指南

## 🎯 适合人群

- ✅ 零基础用户
- ✅ 不想写代码的用户
- ✅ 想要快速创建脚本的用户

## 📝 只需3步！

### 第1步：打开管理页面

1. **登录系统**
   - 访问您的系统地址（例如：`http://localhost:3000`）
   - 使用管理员账号登录

2. **进入自动申请脚本管理**
   - 方法一：点击顶部导航 → "管理" → "自动申请脚本管理"
   - 方法二：直接访问：`http://localhost:3000/admin/auto-apply-scripts`

### 第2步：准备信息

在创建脚本之前，您需要准备：

1. **申请页面URL**
   - 打开浏览器
   - 访问学校的官方网站
   - 找到"申请"或"Apply"链接
   - 点击进入申请页面
   - 复制浏览器地址栏中的完整URL
   - 例如：`https://shanghai-school.edu/apply`

2. **是否需要登录**
   - 如果打开申请页面后，**直接显示申请表单** → 不需要登录
   - 如果打开申请页面后，**要求先登录** → 需要登录

### 第3步：创建脚本

1. **点击"创建新脚本"按钮**
   - 页面右上角的蓝色按钮，带"+"图标

2. **填写表单**
   
   **选择学校**：
   - 点击下拉框
   - 选择要创建脚本的学校
   - 列表中会显示：学校名称 - 项目名称 (学校ID)
   
   **申请页面URL**：
   - 粘贴您刚才复制的申请URL
   - 确保URL完整且正确
   
   **需要登录**：
   - 如果申请前需要登录，勾选此选项
   - 如果不需要，保持不勾选

3. **点击"创建脚本"按钮**
   - 系统会自动处理所有操作
   - 等待几秒钟

4. **查看结果**
   - ✅ 如果成功：会显示绿色成功消息，包含文件路径
   - ❌ 如果失败：会显示红色错误消息，请检查错误信息

## ✅ 完成！

脚本已经创建并自动注册到系统中！

您现在可以：

1. **测试脚本**
   - 进入"可申请学校"页面
   - 找到您刚创建脚本的学校
   - 点击"自动申请"按钮
   - 观察浏览器自动填写和提交

2. **查看脚本列表**
   - 在管理页面可以看到所有已创建的脚本
   - 查看注册状态（已注册/未注册）
   - 查看申请URL等信息

## 🔍 如何找到申请URL？

### 方法一：从学校官网

1. 打开浏览器
2. 访问学校的官方网站
3. 找到"申请"、"Apply"、"在线申请"等链接
4. 点击进入申请页面
5. 复制浏览器地址栏中的URL

### 方法二：从可申请学校页面

1. 在系统中进入"可申请学校"页面
2. 找到目标学校
3. 如果有"官网"链接，点击进入
4. 在学校官网找到申请页面
5. 复制URL

## ❓ 常见问题

### Q1: 找不到"自动申请脚本管理"菜单？

**A**: 
- 确保您使用的是管理员账号登录
- 检查导航栏是否有"管理"或"Admin"菜单
- 或直接访问：`/admin/auto-apply-scripts`

### Q2: 创建脚本后显示"未注册"？

**A**: 
- 这通常不会发生，因为系统会自动注册
- 如果出现，可以手动编辑 `src/modules/auto-apply/autoApplyService.ts` 文件
- 或联系技术支持

### Q3: 如何测试脚本是否工作？

**A**: 
1. 进入"可申请学校"页面
2. 找到您创建脚本的学校
3. 点击"自动申请"按钮
4. 观察浏览器自动操作（需要设置环境变量，见下方）

### Q4: 如何设置环境变量来观察浏览器操作？

**A**: 
1. 在项目根目录创建或编辑 `.env.local` 文件
2. 添加以下内容：
   ```
   PLAYWRIGHT_HEADLESS=false
   ```
3. 重启开发服务器
4. 再次测试自动申请，可以看到浏览器自动操作

### Q5: 脚本创建后可以修改吗？

**A**: 
- 可以！脚本文件保存在：`src/modules/auto-apply/schools/您的学校ID.ts`
- 使用代码编辑器打开文件
- 根据需要进行修改
- 保存后重启服务器即可生效

### Q6: 字段无法自动匹配怎么办？

**A**: 
- 打开脚本文件
- 找到"字段映射"部分（有注释说明）
- 取消注释并添加字段映射
- 例如：
  ```typescript
  const overrides = remapTemplateFields(payload.template, {
    english_first_name: { label: "First Name" },
  });
  ```

## 📚 更多帮助

- **详细文档**：查看 `docs/零基础创建自动申请脚本指南.md`
- **脚本开发指南**：查看 `docs/AUTO_APPLY_SCRIPT_GUIDE.md`
- **快速参考**：查看 `docs/AUTO_APPLY_QUICK_START.md`

## 🎉 总结

使用Web界面创建脚本非常简单：

1. ✅ 打开管理页面
2. ✅ 填写学校信息和申请URL
3. ✅ 点击创建

系统会自动处理所有技术细节，您无需编写任何代码！

